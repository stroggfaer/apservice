/*! Landcarte (c) AT MMXII | http://axtk.me/landcarte | version: 2015/12/25 */
;(function(e){var t={extend:function(e,n,r){var f=t.extend;switch(typeof(e)){case"function":var c=function(){};var s=Array.prototype.slice.call(arguments,2);c.prototype=n.prototype;for(var i=0;i<s.length;i++){if(typeof(s[i])=="function")s[i]=s[i].prototype};s.unshift(e.prototype=new c());f.apply(this,s);e.prototype.constructor=e;e.superclass=n;break;case"object":if(e==null)e={};var o=Array.prototype.slice.call(arguments,1),h=0,l=function(e,t,n){var i=n?n.constructor:null;if(!i)e[t]=n;else if(i==Array){if(!e[t]||typeof(e[t])!="object")e[t]=new Array(n.length);for(var r=0;r<n.length;r++)l(e[t],r,n[r])}else if(i==Object){e[t]=f({},e[t],n)}else e[t]=n};for(var i=0;i<o.length;i++){if(o[i]!=null){var u=o[i].constructor;if(u==Array){for(var a=0;a<o[i].length;a++)l(e,a,o[i][a])}else if(u==Object||u.superclass!=null){for(var a in o[i]){if(o[i].hasOwnProperty(a))l(e,a,o[i][a])}}}};break};return e},text:function(e,t){var r=e,i=this.text;if(e&&t!=null){switch(t.constructor){case Array:var o={};for(var n=0;n<t.length;n++)o[n]=t[n];r=i(e,o);break;case Object:for(var n in t)r=r.replace(new RegExp("\\{"+this.escape(n)+"\\}","g"),t[n]);break;default:r=i(e,{0:t})}};return r},escape:function(e){return e?e.replace(/([\.\*\+\?\|\(\)\[\]\{\}\\\/\:])/g,"\\$1"):e},log:function(){try{console.log.apply(console,arguments)}catch(e){}}};if(e.at&&e.at.extend)t=t.extend(e.at,t);return(e.at=t)})(window);at.util={};at.util.collection={merge:function(e,t){if(this.iterableObject(e)){var r=Array.prototype.slice.call(arguments);r.unshift({});return at.extend.apply(at,r)};var r=[],i={};if(this.iterableArray(e)){for(var n=0;n<e.length;n++){r.push(e[n]);i[e[n]]=1}};if(this.iterableArray(t)){for(var n=0;n<t.length;n++){if(!i[t[n]])r.push(t[n])}};for(var n=2;n<arguments.length;n++)r=this.merge(r,arguments[n]);return r},each:function(e,t){if(e!=null&&t){switch(e.constructor){case Array:for(var n=0;n<e.length;n++)t(n,e[n]);break;case Object:for(var n in e){if(e.hasOwnProperty(n))t(n,e[n])};break;default:t(null,e)}};return e},index:function(e,t){return this.firstIndex(e,t)},firstIndex:function(e,t){var n=-1;this.each(e,function(e,r){if(n==-1&&r==t)n=e});return n},finds:function(e,t){var n=!1;this.each(e,function(e,r){n|=r==t});return!!n},iterableObject:function(e){return e&&e.constructor==Object},iterableArray:function(e){return e&&e.constructor==Array},iterable:function(e){return this.iterableObject(e)||this.iterableArray(e)}};at.geo={};at.geo.ggl={};at.api={alias:function(e,t,n){if(!e)return;var i;if(!n){i={};for(var r in t){if(t.hasOwnProperty(r)&&typeof(t[r])=="function")i[r]=t[r]}}else if(n.constructor==Array){i={};for(var r=0;r<n.length;r++)i[n[r]]=t[n[r]]}else i=n;for(var r in i){if(i.hasOwnProperty(r)){if(typeof(i[r])=="function"){e[r]=(function(e,t){return function(){return e.apply(t,arguments)}})(i[r],t)}else e[r]=i[r]}}}};at.geo.internalization=(function(){var t={lat:"latitude|Latitude|Lat|LAT|phi".split("|"),lon:"longitude|Longitude|Lon|LON|Long|LONG|lambda|lng|Lng|LNG".split("|")};var e=function(e){return typeof(e)=="number"?e:parseFloat(e)},n={toCoordinates:function(n){if(!n)return null;var r=null;switch(n.constructor){case String:var o=n.split(/\s*,\s*/),a=!0;if(!o||o.length<2)return null;r={lat:parseFloat(o[0]),lon:parseFloat(o[1])};break;case Array:if(n.length>1)r={lat:e(n[0]),lon:e(n[1])};break;default:r={lat:n.lat,lon:n.lon};if(r.lat==null){for(var i=0;i<t.lat.length;i++){if(n[t.lat[i]]!=null){r.lat=e(n[t.lat[i]]);break}}}else r.lat=e(r.lat);if(r.lon==null){for(var i=0;i<t.lon.length;i++){if(n[t.lon[i]]!=null){r.lon=e(n[t.lon[i]]);break}}}else r.lon=e(r.lon)};if(r&&(r.lat==null||r.lon==null||isNaN(r.lat)||isNaN(r.lon)))r=null;return r},toBoundingBox:function(e){if(!e)return null;var n=null,t;switch(e.constructor){case Array:if(e.length<2)return null;if(e[0]&&e[0].length&&e[1]&&e[1].length){t=[this.toCoordinates(e[0]),this.toCoordinates(e[1])];if(t[0]==null||t[1]==null)return null;n={sw:t[0],ne:t[1]}}else{t=this.toCoordinates(e);if(t==null)return null;n={sw:t,ne:t}};break;default:if(e.sw==null||e.ne==null)return null;t=[this.toCoordinates(e.sw),this.toCoordinates(e.ne)];n={sw:t[0],ne:t[1]}};return n}};at.api.alias(at.geo,n);return n})();at.geo.ggl.internalization={toCoordinates:function(e){var n=google.maps;if(!e)return null;else if(e.constructor==n.LatLng)return e;var r=null,t=at.geo.toCoordinates(e);if(t)r=new n.LatLng(t.lat,t.lon);return r},toBoundingBox:function(e){var n=google.maps;if(!e)return null;else if(e.constructor==n.LatLngBounds)return e;var r=null,t=at.geo.toBoundingBox(e);if(t){r=new n.LatLngBounds(this.toCoordinates(t.sw),this.toCoordinates(t.ne))};return r},toPolyline:function(e){var a=google.maps;if(!e)return null;else if(e.constructor==a.MVCArray)return e;var i=[],t,r;for(var n=0;n<e.length;n++){t=this.toCoordinates(e[n]);if(t)i.push(t);else{r=[];for(var o=0;o<e[n].length;o++){t=this.toCoordinates(e[n][o]);if(t)r.push(t)};if(r.length)i.push(r)}};return new a.MVCArray(i)},toPolygon:function(e){return this.toBoundingBox(e)},toWeightedData:function(e){var i=google.maps;if(!e)return null;else if(e.constructor==i.MVCArray)return e;var o=[],r,n;for(var t=0;t<e.length;t++){r=this.toCoordinates(e[t].location||e[t]);if(r!=null){n={location:r};if(e[t].weight!=null)n.weight=e[t].weight;else if(e[t][2]!=null)n.weight=e[t][2];o.push(n)}};return new i.MVCArray(o)},toArray:function(e){var t=google.maps;if(!e)return null;else if(e.constructor==t.MVCArray)return e;return new t.MVCArray(e)}};at.geo.ggl.externalization={toCoordinates:function(e){if(!e)return null;var t={lat:e.lat(),lon:e.lng()};return t},toBoundingBox:function(e){if(!e)return null;var t={sw:this.toCoordinates(e.getSouthWest()),ne:this.toCoordinates(e.getNorthEast())};return t},toPolyline:function(e){var i=[],n,r;e=this.toArray(e);for(var t=0;t<e.length;t++){n=this.toCoordinates(e[t]);if(n)i.push(this.toArray(n));else{r=[];e[t]=this.toArray(e[t]);for(var o=0;o<e[t].length;o++){n=this.toCoordinates(e[t][o]);if(n)r.push(this.toArray(n))};if(r.length)i.push(r)}};return i},toPolygon:function(e){return this.toBoundingBox(e)},toWeightedData:function(e){var o=google.maps,i=[],n,r;if(!e)return null;else if(e.constructor==o.MVCArray)n=e.getArray();for(var t=0;t<n.length;t++){r=this.toCoordinates(n[t].location||n[t]);if(r!=null){if(n[t].weight!=null)r.weight=n[t].weight;i.push(r)}};return i},toArray:function(e){var t=e&&e.constructor==Array?e:null;if(e){if(e.constructor==Object)t=[e.lat,e.lon];else{var n=google.maps;switch(e.constructor){case n.MVCArray:t=e.getArray();break;case n.LatLng:t=[e.lat(),e.lng()];break}}};return t}};at.geo.Converter=(function(){var e=function(e){var t=(this.namespace||at.geo)[e];if(!/^(in|ex)ternalization$/.test(e)||!t)throw new Error("unsupported conversion type");this.type=e;this.engine=t};at.extend(e,Object,{run:function(e){var t=this.normalizeInput(arguments),n=this.engine;switch(t.name){case"location":case"coordinates":case"position":case"center":return n.toCoordinates(t.value);case"box":case"bounds":return n.toBoundingBox(t.value)};return t.value},normalizeInput:function(e){var t=e[0];if(typeof(e[0])=="string"&&e.length>1)t={name:t,value:e[1]};return t},condense:function(){var e=this,t=function(){return e.run.apply(e,arguments)};return t}});return e})();at.geo.ggl.Converter=(function(e){var t=function(){at.geo.Converter.apply(this,arguments)};at.extend(t,at.geo.Converter,{run:function(t){var r=this.normalizeInput(arguments),o=this.engine,i=r.value,u=r.callback,n=i,s=google.maps,h=s.visualization||{};var p=this,l=!1,c;switch(r.name){case"coordinates":case"location":case"center":case"position":case s.LatLng:n=o.toCoordinates(i);if(l=!n&&!!u){e.geocode(r.value,function(e){var t={};t[r.name]=o.toCoordinates(e.location);if(r.context==s.Marker)t.address=e.address;u(t,l)})};break;case"bounds":case s.LatLngBounds:n=o.toBoundingBox(i);if(l=!n&&!!u){e.geocode(i,function(e){var t={};t[r.name]=o.toBoundingBox(e.geometry);u(t,l)})};break;case"path":case"paths":if(r.context==s.Polyline||r.context==s.Polygon)n=o.toPolyline(i);break;case s.Polyline:n=o.toPolyline(i.getPath());break;case s.Polygon:n=o.toPolygon(i.getPaths());break;case"origin":case"destination":if(r.context==s.DirectionsRequest){c=o.toCoordinates(i);n=c==null?i:c};break;case"waypoints":n=i.slice();for(var a=0;a<n.length;a++){if(typeof(n[a])=="string")n[a]={location:n[a]};else if(n[a]&&n[a].location){c=o.toCoordinates(n[a].location);if(c!=null)n[a].location=c}};break;case"data":if(r.context==h.HeatmapLayer)n=o.toWeightedData(i);break};if(!l){var g=this.type=="internalization"?"internalize":"externalize";n=e.factory[g](i)||n};if(u&&!l&&r.name){var f={};f[r.name]=n;u(f,l)};return n},normalizeInput:function(e){var t=e[0];if(typeof(e[0])=="string"&&e.length>1){t={name:e[0],value:e[1]};if(typeof(e[2])=="function"){t.callback=e[2];t.context=e[3]}else t.context=e[2]};if(t.value&&!t.name)t.name=t.value.constructor;t.context=this.normalizeContext(t.context);return t},normalizeContext:function(t){if(e.Object&&t instanceof e.Object)t=t.core;if(t&&typeof(t)!="function")t=t.constructor;return t},namespace:at.geo.ggl});return t})(at.geo.ggl);at.geo.ggl.conversion=(function(e){var t={internalize:(new e.Converter("internalization")).condense(),externalize:(new e.Converter("externalization")).condense()};at.api.alias(e,t);return t})(at.geo.ggl);at.geo.ggl.geocoding=(function(e,t){var n={types:{country:["country"],region:["administrative_area_level_1","administrative_area_level_2","administrative_area_level_3"],locality:["locality"],sublocality:["sublocality","point_of_interest","establishment"],street:["street_address","point_of_interest","establishment"],route:["route"]},typeMap:{"route":["street"],"street_number":["streetNumber"],"sublocality":["sublocality"],"locality":["locality"],"postal_code":["postalCode"],"administrative_area_level_2":["province","provinceCode"],"administrative_area_level_1":["region","regionCode"],"country":["country","countryCode"]},typeList:["locality","sublocality","street","region","country","route"]};var i={normalizeData:function(e){var i=this,n=[],r;t.each(e,function(e,t){if(r=i.entry(t))n.push(r)});return n},entry:function(e){var l=e["types"]||[],o=n.typeList,t,i;for(var a=0;a<l.length&&!t;a++){for(var r=0;r<o.length&&!t;r++){for(var s=0;s<n.types[o[r]].length&&!t;s++)if(l[a]==n.types[o[r]][s])t=o[r]}};if(t){i={type:t,name:e["formatted_address"]};this.addressComponents(e,i);this.geometry(e,i)};return i},addressComponents:function(e,r){if(!r)r={};t.each(e["address_components"],function(e,i){t.each(i["types"],function(e,t){var o=n.typeMap[t];if(o){if(o[0])r[o[0]]=i["long_name"];if(o[1])r[o[1]]=i["short_name"]}})});return r},geometry:function(t,n){if(!n)n={};var r=t["geometry"]||{};n.location=e.externalize("location",r["location"]);n.geometry=e.externalize("bounds",r["viewport"]||r["bounds"]||null);n.precision=(r["location_type"]||"").toLowerCase().replace(/_/g," ");return n}};var r={initialize:function(){var e=window.google?google.maps:null;if(!n.service)n.service=new e.Geocoder();return e},run:function(e,t){var a=this.initialize(),r,o=this.normalize(e,n.service);n.service.geocode(o,function(e,n){var o={status:n};if(n===a.GeocoderStatus.OK&&e){o.results=e;o.geoobjects=i.normalizeData(e);if(r=o.geoobjects[0]){var l=["location","geometry","sublocality","locality","region","country","countryCode"];o.address=r.name;for(var s=0;s<l.length;s++)o[l[s]]=r[l[s]]||null}};if(t)t(o)})},normalize:function(n,r){var i={};var a=typeof(r)=="function"?r:r.constructor,o=e.internalize("location",n);if(o)i.location=o;else if(typeof(n)=="string")i.address=n;else{t.each(n,function(t,n){i[t]=e.internalize({name:t,value:n,context:a})})};return i}};at.api.alias(e,r,{geocode:r.run});return r})(at.geo.ggl,at.util.collection);at.geo.ggl.factory=(function(e,t){var n={is:function(e,t){return t&&e instanceof t}};var r={classIndex:{},shortcutOption:{"marker":"position","polyline":"path","polygon":"paths","kmllayer":"url"},constructorSignature:{"groundoverlay":["url","bounds"]},defaultOptions:{"map":{center:[0,0],zoom:1},"marker":{position:[0,0]}},getClass:function(e){switch(typeof(e)){case"function":return e;case"object":return e?e.constructor:null;case"string":var t=e.toLowerCase(),n=t.split(".");var r=n.length>1?n[0]:null;if(this.classIndex[t]||this.scan(r))return this.classIndex[t];break}},scan:function(e){var o=window.google,r=o?o.maps:{};var t=r,i="";if(e){t=r[e];i=e+".";if(!t&&(this.classIndex[e]||this.scan()))t=this.classIndex[e]};for(var n in t){if(t.hasOwnProperty(n)&&typeof(t[n])=="function")this.classIndex[(i+n).toLowerCase()]=t[n]};return!0},getNamespace:function(e,t){var s=window.google,o=s?s.maps:{};var r=o[t]||o,n,a=typeof(e)=="function"?e:e.constructor;for(var i in r){if(r.hasOwnProperty(i)){if(r[i]==a)n=t;else if(!t)n=this.getNamespace(a,i)};if(n)return n}},getIndexedType:function(e){if(!e)return null;var n,t=this.classIndex,i=typeof(e)=="function"?e:e.constructor;for(var r in t){if(i==t[r])n=r};return n},getType:function(e){if(!e)return null;var t=this.getIndexedType(e);if(!t){this.scan(this.getNamespace(e));t=this.getIndexedType(e)};return t},getCoreObject:function(r,i){var z=google.maps,s,l=this.getClass(r),o=Array.prototype.slice.call(arguments,1);if(!r||!l)return;if(n.is(r,e.Object))s=r.core;else if(r.constructor==l)s=r;if(s&&!o.length)return s;var v={};var p=this.getType(l),b,d=0,x=0,m=!1,g=this.constructorSignature[p]||[],c=this.shortcutOption[p],u=this.defaultOptions[p];if(l&&!o.length&&!u)return new l();var y=function(e,t){if(e){if(s||t)at.extend(v,e);d++};if(d==b&&s&&!m){if(s.setValues)s.setValues(v);m=!0}};if(c&&typeof(o[0])!="undefined"&&!g[0]){var f;if(!t.iterableObject(o[0])||!o[0][c]){f=e.internalize({name:c,value:o[0],context:l})};if(f!=null||!t.iterableObject(o[0])){var O=o[0];o[0]={};o[0][c]=f||O}};if(!s&&u){var h=!1;for(var a=0;a<o.length;a++){if(!h&&t.iterableObject(o[a])){o[a]=at.extend({},u,o[a]);h=!0}};if(!h)o.push(u)};for(var a=0;a<o.length;a++){if(g[a]){o[a]=e.internalize({name:g[a],value:o[a],context:l})}else if(t.iterableObject(o[a])){t.each(o[a],function(t,n){var r=e.internalize({name:t,value:n,callback:y,context:l});if(r==null&&u&&u[t]!=null){o[a][t]=e.internalize({name:t,value:u[t],context:l})}else o[a][t]=r;x++})}};b=x;if(!s){var w=function(e){l.apply(this,e)};w.prototype=l.prototype;s=new w(o)}else throw new Error("inappropriate type of geoobject");y();return s},internalize:function(t){var i=this,r;if(typeof(t)=="function"){r=function(){var e=Array.prototype.slice.call(arguments);e[0]=i.externalize(e[0]);return t.apply(i.externalize(this),e)}}else if(n.is(t,e.Object))r=t.core;return r},externalize:function(t){var i=google.maps,o=this,r;if(typeof(t)=="function"){r=function(){var e=Array.prototype.slice.call(arguments);e[0]=o.internalize(e[0]);return t.apply(o.internalize(this),e)}};if(!r&&i.Data){if(n.is(t,i.Data.Geometry))r=new e.data.Shape(t);else if(n.is(t,i.Data.Feature))r=new e.data.Feature(t);else if(n.is(t,i.Data))r=new e.data.Layer(t)};if(!r&&n.is(t,i.MVCObject))r=new e.Object(t);return r}};return r})(at.geo.ggl,at.util.collection);at.geo.ggl.Object=(function(e,t,n){var r=function(e,n){this.core=t.getCoreObject.apply(t,arguments)||new google.maps.OverlayView();this.type=t.getType(this.core);this.listeners=[]};at.extend(r,Object,{attr:function(t,r,i){var o=this;if(typeof(r)=="undefined"){switch(typeof(t)){case"string":var r=this.io("get",t);if(i===!0)return e.externalize({name:t,value:r,context:this});return r;break;case"object":n.each(t,function(e,t){o.attr(e,t,i)});break}}else{e.internalize({name:t,value:r,context:this,callback:function(e){n.each(e,function(e,t){o.io("set",e,t)})}})};return this},prop:function(e,t){return this.attr(e,t,!0)},io:function(e,t,n){if(!t)return;var r=this.core,i=e+t.charAt(0).toUpperCase()+t.substring(1);if(r[i])return r[i](n);else if(r[e])return r[e](t,n)},on:function(n,r,i){var u=this,c=google.maps.event,s=n.split(" "),l,o;for(var a=0;a<s.length;a++){if(r){o=function(n){var o={target:u};if(n){o.originalEvent=n;if(n.latLng)o.location=e.externalize("location",n.latLng);if(e.data){var a=["feature","newGeometry","oldGeometry"];for(var i=0;i<a.length;i++){if(n[a[i]])o[a[i]]=t.externalize(n[a[i]])}}};return r.call(u.core,o)}}else o=null;l={event:s[a],handler:r,xhandler:o};l.core=c[i?"addListenerOnce":"addListener"](this.core,s[a],o);this.listeners.push(l)};return this},once:function(e,t){return this.on(e,t,!0)},off:function(e,t){var o=google.maps.event;if(typeof(e)=="undefined"){o.clearInstanceListeners(this.core);this.listeners=[];return this};var a=e.split(" "),r={};for(var i=0;i<a.length;i++){for(var n=this.listeners.length-1;n>=0;n--){r.event=a[i]==this.listeners[n].event;r.handler=!t||t==this.listeners[n].handler;if(r.event&&r.handler){o.removeListener(this.listeners[n].core);this.listeners.splice(n,1)}}};return this},trigger:function(e){var n=google.maps.event,t=Array.prototype.slice.call(arguments);t.unshift(this.core);n.trigger.apply(n,t);return this},show:function(){return this.toggle(!0,arguments)},hide:function(){return this.toggle(!1)},toggle:function(t,r){if(typeof(t)=="undefined")t=!this.prop("visible");var l=this,i=this.core,s,a,o={};if(r&&r.length){a=[];n.each(r,function(t,n){a[t]=e.internalize({name:t,value:n,context:l})});if(n.iterableObject(r[0]))s=r[0]};if(o.open=(t&!!i.open))i.open.apply(i,a);if(o.close=(!t&!!i.close))i.close();if(!o.open&&!o.close)this.prop("visible",t).prop(s);return this},visible:function(){return(!this.core.getMap||this.core.getMap()!=null)&&this.prop("visible")},bounds:function(){return e.externalize("bounds",this.e$())},e$:function(){var r=this.attr("bounds")||null,n=[],t,i;if(r)return r;else if(t=this.attr("position"))n.push(t);else if(t=this.attr("paths")){for(var e=0;e<t.getLength();e++){i=t.getAt(e);for(var o=0;o<i.getLength();o++)n.push(i.getAt(o))}}else if(t=this.attr("path")){for(var e=0;e<t.getLength();e++)n.push(t.getAt(e))};var r=new google.maps.LatLngBounds();for(var e=0;e<n.length;e++)r.extend(n[e]);return r},fit:function(){if(this.core.getMap)this.core.getMap().fitBounds(this.e$());return this},container:function(){return this.attr("div")||this.attr("container")},remove:function(){var e=this.core;if(e.setMap)e.setMap(null);else if(e.close)e.close();else{var t=this.container();if(t){t.innerHTML=""}};this.t$=!0;return this.off()},removed:function(e){var t;return this.t$||(e&&(t=this.attr("map"))&&t!=e.core)},is:function(e){switch(typeof(e)){case"object":return this==e||this.core==e;case"function":return(this instanceof e)||(this.core instanceof e);case"string":var t=e.toLowerCase();switch(t){case"layer":return/layer$/.test(this.type);case"shape":return/^(polyline|polygon|circle|rectangle)$/.test(this.type);case":visible":return this.visible()};return this.type==t};return!1}});r.instantiate=function(e,t,n){var i=Array.prototype.slice.call(n);if(t!=n[0])i.unshift(t);return r.apply(e,i)};r.instance=function(e){var n=t.getCoreObject.apply(t,e);return new r(n)};r.peel=function(e){return e instanceof r?e.core:e};return r})(at.geo.ggl,at.geo.ggl.factory,at.util.collection);at.geo.ggl.Collection=(function(e,t){var r={filter:function(e,n){if(!e||!e.length||!n)return e||[];var o=[];switch(typeof(n)){case"function":t.each(e,function(e,t){if(n.call(t.core,e,t))o.push(t)});break;case"object":if(t.iterableObject(n)){t.each(e,function(e,r){var i=!0;t.each(n,function(e,t){i&=r.prop(e)==t});if(i)o.push(r)})}else{t.each(e,function(e,t){if(t==n||t.core==n)o.push(t)})};break;case"string":var i=n.split(":"),a;if(i[0]&&i[1]){o=r.filter(e,i[0]);o=r.filter(o,":"+i[1])}else if(i[0]){return r.filter(e,function(e,t){return t.is(n)})}else if(i[1]){switch(a=i[1]){case"first":return e[0];case"last":return e[e.length-1]};var s={odd:function(e,t){return e%2!=0},even:function(e,t){return e%2==0},visible:function(e,t){return t.visible()},invisible:function(e,t){return!t.visible()}};if(s[a])return r.filter(e,s[a])};break};return o}};var n=function(t){var i=[];if(t){if(t.constructor==Array){for(var r=0;r<t.length;r++){if(t[r]instanceof e)i.push(t[r])}}else if(t instanceof n)i=t.items.slice()};this.items=i},a={attr:function(e,n,r){var o=this;if(typeof(n)=="undefined"&&typeof(e)=="string"){var i=[];t.each(this.items,function(t,o){i.push(o.attr(e,n,r))});return i}else{t.each(this.items,function(t,i){i.attr(e,n,r)})};return this},prop:function(e,t){return this.attr(e,t,!0)},eq:function(t){return this.items[t]||new e()},get:function(e){return this.items[e]?this.items[e].core:null},first:function(){return this.eq(0)},last:function(){return this.eq(this.items.length-1)},gt:function(e){return new n(this.items.splice(e+1))},lt:function(e){return new n(this.items.splice(0,e))},each:function(e){t.each(this.items,function(t,n){e.call(n.core,t,n)});return this},bounds:function(){return layer.externalize("bounds",this.e$())},e$:function(){var e=new google.maps.LatLngBounds();t.each(this.items,function(t,n){e.union(n.e$())});return e},fit:function(){var r=this.e$(),e=[];t.each(this.items,function(t,n){var r=n.attr("map"),o=!1;for(var i=0;i<e.length;i++)o|=e[i]==r;if(!o&&r)e.push(r)});for(var n=0;n<e.length;n++)e[n].fitBounds(r);return this},filter:function(t){var i=r.filter(this.items,t);return i instanceof e?i:new n(i)},toArray:function(){return this.items},size:function(){return this.items.length},empty:function(){return!this.items.length}};n.filter=function(e,t){return r.filter(e,t)};var o=["show","hide","toggle","on","off","trigger","remove"];for(var i=0;i<o.length;i++){a[o[i]]=(function(e){return function(){var n=this.items;for(var t=0;t<n.length;t++)n[t][e].apply(n[t],arguments);return this}})(o[i])};return at.extend(n,Object,a)})(at.geo.ggl.Object,at.util.collection);at.geo.ggl.data={};at.geo.ggl.data.Layer=(function(e,t){var n=function(t){e.Object.instantiate(this,t||"data",arguments)};at.extend(n,e.Object,{add:function(t,n,r){switch(t){case"feature":this.core.add(e.Object.peel(n));break;case"geojson":var i=e.internalize("geoJsonOptions",r,this);this.core.addGeoJson(n,i);break;case"style":var o=e.internalize("styleOptions",r,this);this.core.overrideStyle(e.Object.peel(n),o);break};return this},remove:function(t,n){switch(t){case"feature":this.core.remove(e.Object.peel(n));break;case"style":this.core.revertStyle(e.Object.peel(n));break};return this},contains:function(t){return this.core.contains(e.Object.peel(t))},each:function(t){if(t){this.core.forEach(function(n){var r=new e.data.Feature(n);t.call(n,r)})};return this},find:function(t){var n=this.core.getFeatureById(t);return new e.data.Feature(n)},load:function(n,r,i){var o,a=e.internalize("geoJsonOptions",r,this);if(i){o=function(e){var n=[];t.each(e,function(e,t){n.push(t.core)});return i(n)}};this.core.loadGeoJson(n,a,o);return this},geoJSON:function(e){this.core.toGeoJson(e);return this}});return n})(at.geo.ggl,at.util.collection);at.geo.ggl.data.Feature=(function(e){var t=function(t){e.Object.instantiate(this,t||"data.feature",arguments)};at.extend(t,e.Object,{each:function(e){if(e){this.core.forEachProperty(function(t,n){e(n,t)})};return this},data:function(e,t){if(typeof(t)=="undefined")return this.core.getProperty(e);else this.core.setProperty(e,t);return this},removeData:function(e){this.core.removeProperty(e);return this},geoJSON:function(e){this.core.toGeoJson(e);return this}});return t})(at.geo.ggl);at.geo.ggl.data.Shape=(function(e,t){var n=function(t){e.Object.instantiate(this,t,arguments)};at.extend(n,e.Object,{get:function(n){var o=this,r=this.core,i;if(n==null){if(r.getArray){i=r.getArray();t.each(i,function(t,n){i[t]=e.externalize({value:n,context:o})})}else if(r.get){i=e.externalize({value:r.get(),context:this})}}else if(r.getAt){i=e.externalize({value:r.getAt(n),context:this})};return i},size:function(){var e=this.core;if(e.getLength)return e.getLength()}});return n})(at.geo.ggl,at.util.collection);at.geo.ggl.Map=(function(e,t){var n=function(){e.Object.instantiate(this,"map",arguments);this.objects=[]};at.extend(n,e.Object,{add:function(n,r){var a=this.clean(),o=Array.prototype.slice.call(arguments);if(n=="markers"){if(t.iterableArray(r)){t.each(r,function(t,n){var r=new e.Object("marker",n);a.objects.push(r.prop("map",a.core).prop(o[2]))})}else throw new Error("marker set not provided with array of options");}else{var i=e.Object.instance(o);if(!i.is("infowindow"))i.prop("map",this.core);this.objects.push(i)};return this},find:function(t){var r=this,i=e.Collection.filter(this.objects,function(e,t){return!t.removed(r)}),n=new e.Collection(i);return n.filter(t)},has:function(e){return this.find(e).size()},remove:function(n){if(typeof(n)=="undefined"){t.each(this.objects,function(e,t){t.remove()});return e.Object.prototype.remove.call(this)}else this.find(n).remove();return this},fit:function(t,n){var r=this;e.internalize({name:"bounds",value:t,context:this,callback:function(e){var t=e.bounds;if(t!=null&&!t.isEmpty())r.core.fitBounds(t);if(n)n()}});return this},view:function(){return this.fit.apply(this,arguments)},animate:function(n){if(typeof(n)=="string"&&arguments.length>1){var o=n;n={};n[o]=arguments[1]};var r=this.core,i={};t.each(n,function(t,o){var a=null;switch(t){case"center":if(o.x!=null||o.y!=null)r.panBy(o.x||0,o.y||0);else a=function(e){r.panTo(e.center)};break;case"bounds":a=function(e){r.panToBounds(e.bounds)};break;default:i[t]=o};e.internalize({name:t,value:n[t],context:this,callback:a})});return this.prop(i)},clean:function(){var t=this.objects;for(var e=t.length-1;e>=0;e--){if(t[e].removed(this))t.splice(e,1)};return this},data:function(){return e.factory.externalize(this.core.data)}});return n})(at.geo.ggl,at.util.collection);at.geo.ggl.route=(function(e,t){var n={};var r={initialize:function(){var e=window.google?google.maps:null;if(!n.service)n.service=new e.DirectionsService();if(!n.renderer)n.renderer=new e.DirectionsRenderer();return e},setup:function(e){this.initialize();var t=this.normalize(e,n.renderer);n.renderer.setOptions(t);n.rendererOptions=at.extend(n.rendererOptions||{},t)},render:function(e,t){var i=this.initialize(),r=this.normalize(e,n.service);n.service.route(r,function(e,r){if(r===i.DirectionsStatus.OK){n.renderer.setOptions(n.rendererOptions);n.renderer.setDirections(e)};if(t)t(e)})},normalize:function(n,r){var i={};var o=typeof(r)=="function"?r:r.constructor;t.each(n,function(t,n){i[t]=e.internalize({name:t,value:n,context:o})});return i},clear:function(){if(!n.renderer)return;n.renderer.setOptions({map:null,panel:null})}};return r})(at.geo.ggl,at.util.collection);at.geo.ggl.geometry=(function(e){var t={R:null,tolerance:null,ns:function(e){return google.maps.geometry[e]},singlePoint:function(e){if(!e||e.constructor!=Array)return!0;if(e.length==2&&typeof(e[0])=="number"&&typeof(e[1])=="number")return!0;return!1},whenReady:function(t,n,r){var l=[],o=[],a,s=!0,u;if(u=this.singlePoint(t)){if(t&&t.getArray){a=t.getArray();u=!1}else a=[t]}else a=t;var c=function(e,t){if(e!=null){o[e]=t.location;l[e]=!0};if(!s){s=!0;for(var i=0;i<l.length;i++)s&=l[i]};if(s){if(u)o=o[0];var a=r?r(o):o;if(n)n(a);return a}};for(var i=0;i<a.length;i++){o[i]=e.internalize("location",a[i]);s&=(l[i]=o[i]!=null);if(!l[i]){e.internalize("location",a[i],(function(e){return function(t){c(e,t)}})(i))}};return c()}};var n={distance:function(e,n,r){return t.whenReady([e,n],r,function(e){return t.ns("spherical").computeDistanceBetween(e[0],e[1],t.R)})},area:function(e,n){return t.whenReady(e,n,function(e){return t.ns("spherical").computeArea(e,t.R)})},length:function(e,n){return t.whenReady(e,n,function(e){return t.ns("spherical").computeLength(e,t.R)})},heading:function(e,n,r){return t.whenReady([e,n],r,function(e){return t.ns("spherical").computeHeading(e[0],e[1])})},interpolate:function(n,r,i,o){return t.whenReady([n,r],o,function(n){var r=t.ns("spherical").interpolate(n[0],n[1],i);return e.externalize("location",r)})},contains:function(n,r,i){return t.whenReady(n,i,function(n){var i=e.internalize("polygon",r);return t.ns("poly").containsLocation(n,i)})},edge:function(n,r,i){return t.whenReady(n,i,function(n){var i=e.internalize("shape",r);return t.ns("poly").isLocationOnEdge(n,i,t.tolerance)})},decode:function(e,n){var r=t.ns("encoding").decodePath(e);if(n)n(r);return r},encode:function(e,n){return t.whenReady(e,n,function(e){return t.ns("encoding").encodePath(e)})},radius:function(e){if(typeof(e)=="undefined")return t.R;else t.R=e},tolerance:function(e){if(typeof(e)=="undefined")return t.tolerance;else t.tolerance=e},convert:function(){return t.whenReady.apply(t,arguments)}};return n})(at.geo.ggl);(function(e,t){if(e){e.fn.extend({geoMap:function(e){var r=this.eq(0),n=r.data("geomap");if(!n)r.data("geomap",n=new t.Map(r.get(0),e));else n.prop(e);return n}});var n={geocode:function(){t.geocode.apply(t,arguments)},route:t.route,geometry:t.geometry};e.extend(e,n)}})(window.jQuery,at.geo.ggl);